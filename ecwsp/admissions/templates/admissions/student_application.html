{% extends 'base_next.html' %}
{% load staticfiles %}
{% load static from staticfiles %}
{% block extra_head %}
<script type="text/javascript" src="{% static 'js/admissions/student_application.js' %}"></script>
{% endblock %}

{% block content %}
{% verbatim %}

<div class="container custom-application" ng-app="admissions" ng-controller="StudentApplicationController" ng-init="init()">
  <div ng-if="applicationNotComplete()">
    <h1>
      Application For Admission
      <p class="lead">Click on each section title and fill out all fields for each section</p>
    </h1>
    <hr>
      <div class="panel-group" id="accordion">
        <div class="panel panel-default" ng-repeat="section in application_template.sections">
          <div class="panel-heading">
            <h4>
              <a data-toggle="collapse" data-parent="#accordion" href="#section-{{section.id}}">
                {{ section.name }}
              </a>
            </h4>
          </div>
          <div id="section-{{section.id}}" class="panel-collapse collapse">
            <div class="panel-body">
              <p class="lead">
                {{ section.help_text }}
              </p>
              <div class="section-fields col-sm-12">
                <form class="form-horizontal">
                  <div ng-repeat="section_field in section.fields track by $index">
                    <div>
                      <div class="form-group">
                        <label class="control-label col-sm-2">
                          {{ getCustomFieldById(section_field.id).field_label }}
                        </label>
                        <div class="col-sm-7" >
                            <input ng-if="getCustomFieldById(section_field.id).field_type == 'input'" name="{{ getCustomFieldById(section_field.id).field_name }}" type="text" class="form-control" ng-model="section_field.value">
                            <textarea ng-if="getCustomFieldById(section_field.id).field_type == 'textarea'" name="{{ getCustomFieldById(section_field.id).field_name }}" class="form-control" rows="5" ng-model="section_field.value"></textarea>
                            <select ng-if="getCustomFieldById(section_field.id).field_type == 'multiple'" name="{{ getCustomFieldById(section_field.id).field_name }}" class="form-control" ng-model="section_field.value">
                              <option ng-repeat="choice in getCustomFieldChoices(section_field.id) track by $index" value="{{ choice.value }}">{{ choice.display_name }}</option>
                            </select>
                            <span class="help-block">
                              {{ getCustomFieldById(section_field.id).helptext }}
                            </span>
                        </div>
                      </div>
                    </div>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
      <button class="btn btn-success btn-lg" ng-click="submitApplication()">Submit Application</button>
  </div>
  <div ng-if="applicationComplete">
    <button onclick="window.print()" class="hidden-print pull-right btn btn-lg btn-primary">
      <i class="fa fa-print"></i> Print
    </button>
    <h1 class="hidden-print">Application Complete!</h1>
    <p class="lead hidden-print">Please review and print out your completed application for your own records</p>
    <div ng-repeat="section in application_template.sections" class="col-xs-12">
      <h4>{{ section.name }}</h4>
      <hr>
      <div ng-repeat="section_field in section.fields track by $index" class="col-xs-12">
        <div class="col-xs-3">
          <strong>{{ getCustomFieldById(section_field.id).field_label }}</strong>
        </div>
        <div class="col-xs-9">
          {{ section_field.value }}
        </div>
      </div>
    </div>
  </div>
</div>
{% endverbatim %}
{% endblock %}
